<!DOCTYPE HTML>
<!--
	Escape Velocity 2.5 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
{% load staticfiles %}
{% load tw_extras %}

<html>
	<head>
		<title>Trade Wave</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />

		<!-- Global Variable for js -->
		<script language="javascript">var STATIC_URL = "{{ STATIC_URL|escapejs }}";</script>

		<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400italic,700,900" rel="stylesheet" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="css/ie8.css" /><![endif]-->
		<script src="{% static "js/jquery.min.js" %}"></script>
		<script src="{% static "js/jquery.dropotron.min.js" %}"></script>
		<script src="{% static "js/config.js" %}"></script>
		<script src="{% static "js/skel.min.js" %}"></script>
		<script src="{% static "js/skel-panels.min.js" %}"></script>
		<!--noscript-->
		<link rel="stylesheet" type="text/css" href="{% static "css/skel-noscript.css" %}"/>
		<link rel="stylesheet" type="text/css" href="{% static "css/style.css" %}"/>
		<link rel="stylesheet" type="text/css" href="{% static "css/style-desktop.css" %}"/>
		<!--/noscript-->
	</head>
	<body class="homepage">

		{% include "tradewave/header.html" %}

		<!-- Intro Wrapper -->
		<div id="intro-wrapper" class="wrapper wrapper-style1">
			<div class="title">Paying to Vendor {{ vendor_name }}</div>
			<div class="container">
				<div class="row">
					<div class="12u">

						<section id="intro">
							<p class="style1">Transaction total: <strong>$ {{ product_amount }}</strong></p>

								<!-- Credit Form  This should Auto-populate with recommended credits-->
								<form method="post" action="{% url "tradewave:transaction-confirmed" %}">
        					{% csrf_token %}
									<div>
										<div class="row half">
											<!--input type="text" class="text" name="Vendor" id="scredit-vendor" placeholder="Credit" /-->
											<!--select class="text"-->
											<div class="12u">
												{% if user_credits.values|first >= product_amount %}
													<p class="style1"> {{ user_name }} has enough in {{ user_credits.keys|first }} for this transaction </p>
												{% else %}
													<p class="style1"> {{ user_name }} must use multiple credit types for this transaction </p>
												{% endif %}
											</div>

											{% for credit, amount in user_credits.items %}
												{% if forloop.first or product_amount > user_credits.values|first %}
													<div class="6u">
														<input
															type="text"
															class="text"
															name="credit_{{ credit }}"
															id="credit-{{ credit }}"
															value="{{ credit }}"
															readonly>
													</div>
													<div class="6u">
														<input
															type="number"
															min="0.00"
															step="0.01"
															max="{{ amount|floatformat:2 }}"
															class="text"
															name="amount_{{ credit }}"
															id="amount-{{ credit }}"
															value="{% spaceless %}
																{% if forloop.first %}
																	{% if product_amount > amount %}
																		{{ amount|floatformat:2 }}
																	{% else %}
																		{{ product_amount|floatformat:2 }}
																	{% endif %}
																{% else %}
																	{% if product_amount|subtractfirst:user_credits > amount %}
																		{{ amount }}
																	{% else %}
																		{{ product_amount|subtractfirst:user_credits }}
																	{% endif %}
																{% endif %}
															{% endspaceless %}">
													</div>
													<div class="12u">
														<br>
													</div>
												{% endif %}
											{% empty %}
												<div class="12u">
													<strong> User has no credits in the account </strong>
												</div>
											{% endfor %}
											<!--/select-->
										</div>

									<div class="row half">
										<div class="12u">
											<input type="hidden" class="text" name="{{ product_amount }}" id="product-amount" value="{{ product_amount }}" readonly>
										</div>
									</div>


									{% if product_amount > user_total %}
										<div class="12u">
												<p class="style1"> ${{ product_amount|subtract:user_total }} is the remaining balance for this transaction </p>
										</div>
									{% endif %}

									<!--div class="row half">
										<div class="12u">
										<These controls should allow you to add additional types of credits>
											<ul class="actions">
												<li><a href="#" class="button button-style3 button">+</a></li>
												<li><a href="#" class="button button-style3 button">-</a></li>
											</ul>
										</div>
									</div-->

									<div class="row">
										<div class="12u">
											<ul class="actions">
											<!-- Be sure to verify that the correct amount has been sent -->
												<li><input type="submit" url="{% url "tradewave:transaction-confirmed" %}" class="button button-style3 button-big" value="Complete" /></li>
												<li><input type="reset" class="button button-style2 button-big" value="Reset" /></li>
											</ul>
										</div>
									</div>
								</div>
							</form>
							<!-- /Credit Form -->

						</section>

					</div>
				</div>
			</div>
		</div>

		{% include "tradewave/footer.html" %}

	</body>
</html>
